{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}

<style>
/* --- CSS-Only Bar Chart --- */
.chart-card {
    padding: 20px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    margin-bottom: 25px;
}

.bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 15px;
    height: 200px;
}

.bar-wrapper {
    text-align: center;
    flex: 1;
}

.bar {
    width: 20px;
    background: #4a90e2;
    border-radius: 5px 5px 0 0;
    transition: 0.3s;
}

.bar:hover {
    background: #357ab8;
    transform: translateY(-5px);
}

.bar-label {
    display: block;
    margin-top: 5px;
    font-size: 0.8rem;
    color: #555;
}
</style>



<div class="container mt-4">

 <div class="row p-4 bg-light shadow-sm mb-4" style="border-radius: 12px;">
    <div class="col-12">
      <h3 class="fw-bold mb-1">
        Welcome,
        <span class="text-danger">"{{ username }}"</span>
      </h3>

      <h5 class="text-muted">--Your day to make every interaction count begins now.</h5>

      <div class="mt-3">
        <span class="badge bg-success fs-5 p-2 me-2" style="border-radius: 20px;">
          {{ role }}
        </span>

        <span class="badge text-light bg-primary fs-5 p-2 me-2" style="border-radius: 20px;">
          {{ company_name }}
        </span>
      </div>
    </div>
  </div>

<div class="row mb-4">
  <div class="col-12">
    <div class="shadow-sm bg-white" style="border-radius: 12px; overflow: hidden;">
      <img src="{% static 'images/dashboard.png' %}"
           class="img-fluid w-100"
           alt="Dashboard Illustration"
           style="height: 300px; object-fit: cover; width: 100%;">
    </div>
  </div>
</div>

<!-- ===== Quick Action Cards ===== -->
<div class="row justify-content-center mb-5">

  <!-- Inventory Card -->
  <div class="col-md-3 col-sm-6 col-10 mb-4">
    <a href="{% url 'inventory:category_list' %}" class="text-decoration-none text-dark">
      <div class="card text-center shadow-lg border-0 py-5 hover-shadow transition-all" style="border-radius: 15px;">
        <div class="card-body">
          <i class="ti-package text-primary" style="font-size: 3rem;"></i>
          <h4 class="fw-bold mt-3">Inventory</h4>
        </div>
      </div>
    </a>
  </div>

  <!-- Orders Card -->
  <div class="col-md-3 col-sm-6 col-10 mb-4">
    <a href="{% url 'transaction:order_list' %}" class="text-decoration-none text-dark">
      <div class="card text-center shadow-lg border-0 py-5 hover-shadow transition-all" style="border-radius: 15px;">
        <div class="card-body">
          <i class="ti-shopping-cart text-success" style="font-size: 3rem;"></i>
          <h4 class="fw-bold mt-3">Orders</h4>
        </div>
      </div>
    </a>
  </div>

  <!-- Services Card -->
  <div class="col-md-3 col-sm-6 col-10 mb-4">
    <a href="{% url 'transaction:service_list' %}" class="text-decoration-none text-dark">
      <div class="card text-center shadow-lg border-0 py-5 hover-shadow transition-all" style="border-radius: 15px;">
        <div class="card-body">
          <i class="ti-bar-chart text-info" style="font-size: 3rem;"></i>
          <h4 class="fw-bold mt-3">Service</h4>
        </div>
      </div>
    </a>
  </div>

  <!-- Leads Card -->
  <div class="col-md-3 col-sm-6 col-10 mb-4">
    <a href="{% url 'customers:lead_list' %}" class="text-decoration-none text-dark">
      <div class="card text-center shadow-lg border-0 py-5 hover-shadow transition-all" style="border-radius: 15px;">
        <div class="card-body">
          <i class="ti-user text-warning" style="font-size: 3rem;"></i>
          <h4 class="fw-bold mt-3">Leads</h4>
        </div>
      </div>
    </a>
  </div>

</div>
<div class="d-flex justify-content-end mb-3">
    <form method="get" class="d-flex align-items-center">
        <label class="me-2 fw-bold">Select Year:</label>
        <select name="year" class="form-select form-select-sm w-auto" onchange="this.form.submit()">
            {% for i in year_options %}
                <option value="{{ i }}" {% if i == selected_year %}selected{% endif %}>{{ i }}</option>
            {% endfor %}
        </select>
    </form>
</div>

<div class="chart-card my-4">
    <h5 class="fw-bold mb-3">Order Growth ({{ selected_year }})</h5>

    <div class="bar-chart">
        {% for month, value in chart_data %}
        <div class="bar-wrapper">
            <div class="text-center fw-bold" style="font-size: 0.8rem; color:#333;">
                {{ value }}
            </div>

            <div class="bar" style="height: {{ value }}px;"></div>
            <span class="bar-label">{{ month }}</span>
        </div>
        {% endfor %}
    </div>
</div>


<div class="row text-center my-5">
  <div class="col-md-3 col-6 mb-3">
    <div class="card bg-dark shadow-sm border-0 py-3">
      <h5 class="text-light mb-3">Total Orders</h5>
      <h4 class="fw-bold text-info">{{ total_orders }}</h4>
    </div>
  </div>

  <div class="col-md-3 col-6 mb-3">
    <div class="card bg-dark shadow-sm border-0 py-3">
      <h5 class="text-light mb-3">Total Customers</h5>
      <h4 class="fw-bold text-success">{{ total_customers }}</h4>
    </div>
  </div>

  <div class="col-md-3  col-6 mb-3">
    <div class="card bg-dark shadow-sm border-0 py-3">
      <h5 class="text-light mb-3">Pending Orders</h5>
      <h4 class="fw-bold text-danger">{{ pending_orders }}</h4>
    </div>
  </div>

  <div class="col-md-3 col-6 mb-3">
    <div class="card bg-dark shadow-sm border-0 py-3">
      <h5 class="text-light mb-3">Out of Stock</h5>
      <h4 class="fw-bold text-warning">{{ out_of_stock }}</h4>
    </div>
  </div>
</div>

</div>

{% endblock %}
